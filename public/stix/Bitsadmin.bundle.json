{
    "type": "bundle",
    "id": "bundle--<B1>",
    "objects": [
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--ccf6f785-b4d0-4925-bfb0-042353338205",
            "created": "2025-10-28T11:20:30Z",
            "modified": "2025-10-28T11:20:30Z",
            "name": "Bitsadmin.exe file download",
            "description": "Detects bitsadmin.exe usage to transfer or create+addfile from HTTP/HTTPS URLs.",
            "indicator_types": [
                "malicious-activity"
            ],
            "pattern": "[process:name = 'bitsadmin.exe' AND (process:command_line MATCHES '^.*\\s/transfer\\s.*$' OR (process:command_line MATCHES '^.*\\s/create\\s.*$' AND process:command_line MATCHES '^.*\\s/addfile\\s.*$' AND process:command_line MATCHES '^.*https?://.*$'))]",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-10-28T11:20:30Z",
            "labels": [
                "windows",
                "lolbin",
                "bitsadmin",
                "download"
            ],
            "external_references": [
                {
                    "source_name": "csv_rules_reference",
                    "description": "Derived from project CSV rules for Bitsadmin.exe"
                }
            ]
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--dc42eb57-4c53-460a-93bf-f04504e91e75",
            "created": "2025-10-28T11:20:30Z",
            "modified": "2025-10-28T11:20:30Z",
            "name": "Bitsadmin.exe persistence behaviour and remote downloads",
            "description": "Detects bitsadmin.exe with SetNotifyCmdLine and suspicious parents, or Addfile with protocol URLs, or /transfer with protocol URLs.",
            "indicator_types": [
                "malicious-activity"
            ],
            "pattern": "[process:command_line MATCHES '^.*bitsadmin.*$' AND ((process:command_line MATCHES '^.*SetNotifyCmdLine.*$' AND (process:command_line MATCHES '^.*%COMSPEC%.*$' OR process:command_line MATCHES '^.*cmd\\.exe.*$' OR process:command_line MATCHES '^.*regsvr32\\.exe.*$')) OR (process:command_line MATCHES '^.*Addfile.*$' AND (process:command_line MATCHES '^.*http:.*$' OR process:command_line MATCHES '^.*https:.*$' OR process:command_line MATCHES '^.*ftp:.*$' OR process:command_line MATCHES '^.*ftps:.*$')) OR (process:command_line MATCHES '^.*\\s/transfer\\s.*$' AND (process:command_line MATCHES '^.*http.*$' OR process:command_line MATCHES '^.*https.*$')))]",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-10-28T11:20:30Z",
            "labels": [
                "windows",
                "lolbin",
                "bitsadmin",
                "persistence",
                "download"
            ],
            "external_references": [
                {
                    "source_name": "csv_rules_reference",
                    "description": "Derived from project CSV rules for Bitsadmin.exe"
                }
            ]
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--c583ca00-dd77-41df-b898-5dc074c810d1",
            "created": "2025-10-28T11:20:30Z",
            "modified": "2025-10-28T11:20:30Z",
            "name": "Bitsadmin.exe usage of transfer/download/upload parameters",
            "description": "Detects bitsadmin.exe with transfer (and optionally download/upload) parameters and URLs.",
            "indicator_types": [
                "malicious-activity"
            ],
            "pattern": "[process:name = 'bitsadmin.exe' AND process:command_line MATCHES '^.*transfer.*$' AND (process:command_line MATCHES '^.*http.*$' OR process:command_line MATCHES '^.*https.*$' OR process:command_line MATCHES '^.*download.*$' OR process:command_line MATCHES '^.*upload.*$')]",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-10-28T11:20:30Z",
            "labels": [
                "windows",
                "lolbin",
                "bitsadmin",
                "parameters"
            ],
            "external_references": [
                {
                    "source_name": "csv_rules_reference",
                    "description": "Derived from project CSV rules for Bitsadmin.exe"
                }
            ]
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--cabccabb-c6b9-43dd-9434-7e0fc5ecde63",
            "created": "2025-10-28T11:20:30Z",
            "modified": "2025-10-28T11:20:30Z",
            "name": "Bitsadmin.exe IOCs (suspicious parent processes)",
            "description": "Detects bitsadmin.exe started by common parent processes frequently used to spawn LOLBINs.",
            "indicator_types": [
                "malicious-activity"
            ],
            "pattern": "[process:name = 'bitsadmin.exe' AND (process:parent_ref.name = 'cmd.exe' OR process:parent_ref.name = 'powershell.exe' OR process:parent_ref.name = 'explorer.exe' OR process:parent_ref.name = 'services.exe')]",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-10-28T11:20:30Z",
            "labels": [
                "windows",
                "lolbin",
                "bitsadmin",
                "ioc"
            ],
            "external_references": [
                {
                    "source_name": "csv_rules_reference",
                    "description": "Derived from project CSV rules for Bitsadmin.exe"
                }
            ]
        }
    ]
}