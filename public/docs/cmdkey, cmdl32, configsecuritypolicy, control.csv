title;binary;rule;description;link;columns
CmdKey.exe;CmdKey.exe;"process.name : (*cmdkey.exe) or process.executable : *cmdkey.exe and process.command_line : (""* -l *"" or ""* /l *"")";Detects usage of cmdkey to look for cached credentials on the system;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmdkey_recon.yml ;"[""timestamp"",""user.name"",""host.name"",""process.executable"",""process.command_line"",""process.parent.name""]"
Command line usage to install specially formatted local .inf files;Cmdl32.exe;"process.name: (cmstp.exe or CMSTP.EXE) or process.executable : (*cmstp.exe or *CMSTP.EXE) and process.command_line : (""* /s*"" or ""* -s *"" or ""* -au *"" or ""* /au *"" or ""* /ni *"" or ""* -ni *"" )";Detect commandline usage of Microsoft Connection Manager Profile Installer (cmstp.exe) to install specially formatted local .INF files;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_uac_bypass_cmstp.yml ;"[""timestamp"",""user.name"",""host.name"",""process.executable"",""process.command_line"",""process.parent.name""]"
Load of dll or ocx files from suspicious locations;Cmdl32.exe;process.executable : (*cmstp.exe) and file.path : (*PerfLogs* or *ProgramData* or *Users* or (*Windows* and *Temp*) or (*C* and *Temp*)) and file.path : (*.dll or *.ocx) ;"Detects cmstp loading ""dll"" or ""ocx"" files from suspicious locations";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/image_load/image_load_cmstp_load_dll_from_susp_location.yml ;"[""timestamp"",""user.name"",""host.name"",""process.executable"",""process.command_line"",""process.parent.name""]"
File, credentials or data exfiltration ;ConfigSecurityPolicy.exe ;"process.command_line : (*ConfigSecurityPolicy.exe) or process.executable: (*ConfigSecurityPolicy.exe) or file.name: (*ConfigSecurityPolicy.exe) and process.command_line : (""*https://*"" or ""*http://*"" or ""*ftp://*"")";Upload file, credentials or data exfiltration with Binary part of Windows Defender;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_lolbin_configsecuritypolicy.yml ;"[""timestamp"",""user.name"",""host.name"",""process.executable"",""process.command_line"",""process.parent.name""]"
CVE-2021-40444 via suspicious patterns ;Control.exe;process.executable : (*control.exe) and process.parent.executable : (*winword.exe or *powerpnt.exe or *excel.exe) and not (process.command_line : (*control.exe input.dll));Detects potential exploitation of CVE-2021-40444 via suspicious process patterns seen in in-the-wild exploitations;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules-emerging-threats/2021/Exploits/CVE-2021-40444/proc_creation_win_exploit_cve_2021_40444.yml ;"[""timestamp"",""user.name"",""host.name"",""process.executable"",""process.command_line"",""process.parent.name""]"
Suspicious Rundll32 from control.exe ;Control.exe;"process.parent.executable : (""*System32\control.exe"") and (process.name: (RUNDL32.EXE or rundll32.exe) or process.executable : (*RUNDL32.EXE or *rundll32.exe)) and not process.executable: (*Shell32.dll)";Detects suspicious Rundll32 execution from control.exe as used by Equation Group and Exploit Kits;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_rundll32_susp_control_dll_load.yml ;"[""timestamp"",""user.name"",""host.name"",""process.executable"",""process.command_line"",""process.parent.name""]"
Unusual instances of Control Panel with suspicious keywords or paths in the process command line;Control.exe;"process.executable : (""?:\\Windows\\SysWOW64\\control.exe"" or ""?:\\Windows\\System32\\control.exe"") and event.type : (start or process_started) and process.command_line :(""*.jpg*"" or ""*.png*"" or ""*.gif*"" or ""*.bmp*"" or ""*.jpeg*"" or ""*.TIFF*"" or ""*.inf*"" or ""*.dat*"" or ""*.cpl:*/*"" or ""*../../..*"" or ""*/AppData/Local/*"" or ""*:\\Users\\Public\\*"" or ""*\\AppData\\Local\\*"")";Identifies unusual instances of Control Panel with suspicious keywords or paths in the process command line value. Adversaries may abuse Control.exe to proxy execution of malicious code.;https://github.com/elastic/detection-rules/blob/0875c1e4c4370ab9fbf453c8160bb5abc8ad95e7/rules/windows/defense_evasion_execution_control_panel_suspicious_args.toml  ;"[""timestamp"",""user.name"",""host.name"",""process.executable"",""process.command_line"",""process.parent.name""]"
Processes runnig from Alternate Data Streams;Control.exe;"event.type : (start) and process.args: (""?:\\*:*"") and process.args_count : 1";Identifies processes running from an Alternate Data Stream. This is uncommon for legitimate processes and sometimes done by adversaries to hide malware.;https://github.com/elastic/detection-rules/blob/61afb1c1c0c3f50637b1bb194f3e6fb09f476e50/rules/windows/defense_evasion_unusual_dir_ads.toml;"[""timestamp"",""user.name"",""host.name"",""process.executable"",""process.command_line"",""process.parent.name""]"
