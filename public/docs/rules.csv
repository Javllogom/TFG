Binary;Title;Rule;Description;Link;Columns
AppInstaller.exe ;Detection of usage of AppInstaller.exe;process.executable : (*Program Files* and *WindowsApps* and *Microsoft.DesktopAppInstaller_* and *AppInstaller.exe);"AppInstaller.exe is spawned by the default handler for the ""ms-appinstaller"" URI. It attempts to load/install a package from the referenced URL ";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/dns_query/dns_query_win_lolbin_appinstaller.yml  ;timestamp, user.name, host.name, process.executable, process.command_line, process.parent.name
Bitsadmin.exe ;File download;"process.name : ""bitsadmin.exe"" and (process.command_line : ""* /transfer  *"" or (process.command_line : ""* /create *"" and process.command_line : ""* /addfile *"" and process.command_line : ""*http*""))";Detects usage of bitsadmin downloading a file;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_bitsadmin_download.yml  ;timestamp, user.name, host.name, process.executable, process.command_line, process.parent.name
Bitsadmin.exe ;Persistance behaviour and remote downloads;"process.command_line : ""*bitsadmin*"" and ((process.command_line :""*SetNotifyCmdLine*"" and (process.command_line : ""*%COMSPEC%*"" or process.command_line : ""*cmd.exe*"" or process.command_line : ""*regsvr32.exe*"")) or (process.command_line :""*Addfile*"" and  (process.command_line : ""*http:*"" or process.command_line :""*https:*"" or process.command_line : ""*ftp:*"" or process.command_line : ""*ftps:*"")))";BITS will allow you to schedule a command to execute after a successful download to notify you that the job is finished. When the job runs on the system the command specified in the BITS job will be executed. This can be abused by actors to create a backdoor within the system and for persistence. It will be chained in a BITS job to schedule the download of malware/additional binaries and execute the program after being downloaded;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_bitsadmin_potential_persistence.yml  ;timestamp, user.name, host.name, process.executable, process.command_line, process.parent.name
Bitsadmin.exe ;"Usage of ""transfer"", ""download"" or ""upload"" parameters ";"process.name : ""bitsadmin.exe"" and process.command_line :""*transfer*"" and (process.command_line: (""*http*"" or ""*https*"") or (process.command_line:(""*download*"" or ""*upload*"")))";The following query identifies Microsoft Background Intelligent Transfer Service utility `bitsadmin.exe` using the `transfer` parameter to download a remote object. In addition, look for `download` or `upload` on the command-line, the switches are not required to perform a transfer. Capture any files downloaded. Review the reputation of the IP or domain used. Typically once executed, a follow on command will be used to execute the dropped file. Note that the network connection or file modification events related will not spawn or create from `bitsadmin.exe`, but the artifacts will appear in a parallel process of `svchost.exe` with a command-line similar to `svchost.exe -k netsvcs -s BITS`. It's important to review all parallel and child processes to capture any behaviors and artifacts. In some suspicious and malicious instances, BITS jobs will be created. ;https://github.com/splunk/security_content/blob/3f77e24974239fcb7a339080a1a483e6bad84a82/detections/endpoint/bitsadmin_download_file.yml ;timestamp, user.name, host.name, process.executable, process.command_line, process.parent.name
Bitsadmin.exe ;IOCs;"process.name :""bitsadmin.exe"" and ((event.action : ""start"" and process.parent.name :""bitsadmin.exe"") or  (event.action :(""creation"" or ""file_create"")) or (file.name :""*:*""))";Detects potentially malicious behavior involving BITS via bitsadmin.exe. This includes suspicious child processes spawned from bitsadmin.exe, creation of new files, and usage of alternate data streams;https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/   ;timestamp, user.name, host.name, process.executable, process.command_line, process.parent.name
