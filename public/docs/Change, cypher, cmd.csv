title;binary;rule;description;link;columns
IOC Execution of child process outside of its normal path;Change.exe;process.parent.name: (*change.exe or *Change.exe) and not process.executable: ((*Windows* or *windows* and *system32*) or (*windows* or *Windows* and *syswow64*)) ;Change.exe being executed and executes a child process outside of its normal path of c:\windows\system32\ or c:\windows\syswow64\;https://lolbas-project.github.io/lolbas/Binaries/Change/ ;"[""timestamp"",""user.name"",""host.name"",""process.executable"",""process.command_line"",""process.parent.name""]"
Usage of cipher utility to overwrite deleted data from disk;Cipher.exe;process.name: (*cipher.exe or *CIPHER.EXE) or process.executable : (*cipher.exe or *CIPHER.EXE) and process.command_line : (*/w*);"Detects usage of the ""cipher"" built-in utility in order to overwrite deleted data from disk. Adversaries may destroy data and files on specific systems or in large numbers on a network to interrupt availability to systems, services, and network resources. Data destruction is likely to render stored data irrecoverable by forensic techniques through overwriting files or data on local and remote drives ";https://github.com/SigmaHQ/sigma/blob/c7998c92b3c5f23ea67045bee8ee364d2ed1a775/rules/windows/process_creation/proc_creation_win_cipher_overwrite_deleted_data.yml ;"[""timestamp"",""user.name"",""host.name"",""process.executable"",""process.command_line"",""process.parent.name""]"
Execution from Alternate Data Stream (ADS);Cmd.exe;"process.command_line : ""*txt:*"" and (process.command_line : (*type * and ""* > *"") or process.command_line : (*makecab* and *.cab*) or process.command_line :(*reg * and * export*) or process.command_line : (*regedit * and ""* /E *"") or process.command_line : (*esentutl * and ""* /y *"" and ""* /d *"" and ""* /o *"" ))";Detects execution from an Alternate Data Stream (ADS). Adversaries may use NTFS file attributes to hide their malicious data in order to evade detection;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_susp_alternate_data_streams.yml  ;
Processes running from ADS;Cmd.exe;"event.type: start and process.args : (""?:\\*:*"") and process.args_count: 1";Identifies processes running from an Alternate Data Stream. This is uncommon for legitimate processes and sometimes done by adversaries to hide malware.;https://github.com/elastic/detection-rules/blob/61afb1c1c0c3f50637b1bb194f3e6fb09f476e50/rules/windows/defense_evasion_unusual_dir_ads.toml ;
Creation of ADS on highly targeted files;Cmd.exe;"event.type : creation and process.executable : (""C:*"" and ""*:*"") and not process.executable : (""C:*"" and ""*:zone.identifier*"") and file.extension : (pdf or dll or png or exe or dat or com or bat or cmd or sys or vbs or ps1 or hta or txt or vbe or js or wsh or docx or doc or xlsx or xls or pptx or pptrtf or gif or jpg or png or bmp or img or iso)";Identifies suspicious creation of Alternate Data Streams on highly targeted files. This is uncommon for legitimate files and sometimes done by adversaries to hide malware.;https://github.com/elastic/detection-rules/blob/414d32027632a49fb239abb8fbbb55d3fa8dd861/rules/windows/defense_evasion_unusual_ads_file_creation.toml ;
"Usage of "">"" to redirect information in command line";Cmd.exe;"process.name : cmd.exe and process.command_line : ""*>*"" and not process.command_line : ((""*Program Files (x86)*"" and ""*Internet Download Manager*"" and ""*IDMMsgHost.exe*"") or (""*chrome-extension*"") or (*pipe* and ""*chrome.nativeMessaging*"")) ";"Detects the use of the redirection character "">"" to redicrect information in commandline ";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_redirect.yml ;
Usage of cmd key to look for cached credentials;Cmd.exe;"process.name: cmdkey.exe and process.command_line : (""*/l*"" or ""*-l*"")";Detects usage of cmdkey to look for cached credentials on the system;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmdkey_recon.yml ;
Download of payload to evade antivirus;Cmd.exe;" process.name: (cmdl32.exe or CMDL32.EXE) and process.command_line : (""//vpn"" or ""//lan"")";Lolbas Cmdl32 is use to download a payload to evade antivirus ;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_lolbin_cmdl32.yml ;
Suspicious cmd execution via WMI on remote host ;Cmd.exe;"process.name: cmd.exe and process.parent.name : *WmiPrvSE.exe and process.parent.command_line : ""*127.0.0.1*"" and process.command_line : (""2>&1"" or ""1>"")";Detects suspicious command execution (cmd) via Windows Management Instrumentation (WMI) on a remote host. This could be indicative of adversary lateral movement.;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/deprecated/windows/proc_creation_win_susp_cmd_exectution_via_wmi.yml ;
Payload obfuscation ;Cmd.exe;"process.command_line : (""*^^*"" or ""*^|^*"" or ""*,;,*"" or ""*;;;;*"" or ""*;; ;;*"" or ""*(,(,))*"" or ""*%COMSPEC:~*"" or ""*c^m^d*"" or ""*^c^m^d*"" or ""*c^md*"" or ""*cm^d*"" or ""*cm^d*"" or ""*^cm^d*"" or ""*s^et*"" or ""*s^e^t*"" or ""*se^t*"")";Detects possible payload obfuscation via the command line;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_dosfuscation.yml ;
Suspicious command line containing an URL and AppData string;Cmd.exe;"process.command_line : (""*^^*"" or ""*^|^*"" or ""*,;,*"" or ""*;;;;*"" or ""*;; ;;*"" or ""*(,(,))*"" or ""*%COMSPEC:~*"" or ""*c^m^d*"" or ""*^c^m^d*"" or ""*c^md*"" or ""*cm^d*"" or ""*cm^d*"" or ""*^cm^d*"" or ""*s^et*"" or ""*s^e^t*"" or ""*se^t*"")";Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers (js/vbs > powershell);https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_http_appdata.yml ;
"Execution of ""del/erase"" to delete files";Cmd.exe;" process.name: *cmd.exe and process.command_line : ((*del* or *erase*) and (""*//f*"" or ""*//s*"" or ""*//q*"" )";"Detects execution of the builtin ""del""/""erase"" commands in order to delete files. Adversaries may delete files left behind by the actions of their intrusion activity. Malware, tools, or other non-native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how. Removal of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint.";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_del_execution.yml ;
"Usage of ""dir"" command";Cmd.exe;"process.command_line : (*dir* and ""*/s*"" and ""*/b*"" )";"Detects usage of the ""dir"" command that's part of windows batch/cmd to collect information about directories";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_dir_execution.yml  ;
Creation of symbolic link between cmd.exe and osk.exe ;Cmd.exe;process.name: *cmd.exe and process.command_line : (*mslink* and *osk.exe* and *cmd.exe*);"Detects the creation of a symbolic link between ""cmd.exe"" and the accessibility on-screen keyboard binary (osk.exe) using ""mklink"". This technique provides an elevated command prompt to the user from the login screen without the need to log in.";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_mklink_osk_cmd.yml ;
Potential path traversal attempt;Cmd.exe;"process.name: *cmd.exe or process.parent.name: *cmd.exe and process.parent.command_line :(""*/c*"" or ""*/k*"" or ""*/r*"") or process.command_line : (""*/c*"" or ""*/k*"" or ""*/r*"") and not process.command_line :(*Tasktop* and *keycloak* and *bin* and *jre* and *java*)";Detects potential path traversal attempt via cmd.exe. Could indicate possible command/argument confusion/hijacking;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_path_traversal.yml ;
"Usage of ""<"" to read and execute files via cmd.exe";Cmd.exe;"process.name : *cmd.exe and process.command_line : ""*<*""";"Detect the use of ""<"" to read and potentially execute a file via cmd.exe";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_stdin_redirect.yml ;
Usage and installation of a backdoor;Cmd.exe;process.parent.name *winlogon.exe and process.name : (*cmd.exe or *cscript.exe or *mshta.exe or *powershell.exe or *pwsh.exe or *regsvr32.exe or *rundll32.exe or *wscript.exe or *wt.exe) and process.command_line :(*sethc.exe* or *utilman.exe* or *osk.exe* or *Magnify.exe* or *Narrator.exe* or *DisplaySwitch.exe*);Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_sticky_key_like_backdoor_execution.yml ;
Suspicious parent;Cmd.exe;process.name: *cmd.exe and process.parent.name: (*csrss.exe or *ctfmon.exe or *dllhost.exe or *epad.exe or *FlashPlayerUpdateService.exe or *GoogleUpdate.exe or *jucheck.exe or *jusched.exe or *LogonUI.exe or *lsass.exe or *regsvr32.exe or *SearchIndexer.exe or *SearchProtocolHost.exe or *SIHClient.exe or *sihost.exe or *slui.exe or *spoolsv.exe or *sppsvc.exe or *taskhostw.exe or *unsecapp.exe or *WerFault.exe or *wergmgr.exe or *wlanext.exe or *WUDFHost.exe) ;Detects suspicious parent process for cmd.exe ;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_unusual_parent.yml ;
"File association changes using ""assoc""";Cmd.exe;process.name: *cmd.exe and process.command_line : *assoc*;"Detects file association changes using the builtin ""assoc"" command. When a file is opened, the default program used to open the file (also called the file association or handler) is checked. File association selections are stored in the Windows Registry and can be edited by users, administrators, or programs that have Registry access or by administrators using the built-in assoc utility. Applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened.";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_assoc_execution.yml ;
"Execution of ""rmdir"" command to delete directories. ";Cmd.exe;"process.name: *cmd.exe and process.command_line : *rmdir* and process.command_line : (""*/s*"" or ""*/q*"" )";"Detects execution of the builtin ""rmdir"" command in order to delete directories. Adversaries may delete files left behind by the actions of their intrusion activity. Malware, tools, or other non-native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how. Removal of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint.";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_rmdir_execution.yml ;
Shadow Copy;Cmd.exe;"process.command_line : (*copy * and ""*\\\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy*""";"Detects the execution of the builtin ""copy"" command that targets a shadow copy (sometimes used to copy registry hives that are in use)";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_shadowcopy_access.yml ;
Command lines missing spaces, indicator of obfuscation;Cmd.exe;"(process.command_line : (""*cmd.exe/c*"" or ""*\cmd/c*"" or ""*cmd/c*"" or ""*cmd.exe/k*"" or ""*\cmd/k*"" or ""*cmd/k*"" or ""*cmd.exe/r*"" or ""*\cmd/r*"" or ""*cmd/r*"")) or (process.command_line : (*cwhoami* or *cpowershell* or *cschtasks* or *cbitsadmin* or *ccertutil* or *kwhoami* or *kpowershell* or *kschtasks* or *kbitsadmin* or *kcertutil*)) and not ((process.command_line : (""*cmd.exe /c*"" or ""*cmd /c*"" or ""*cmd.exe /k*"" or ""*cmd /k*"" or ""*cmd.exe /r*"" or ""*cmd /r*"")) or (process.command_line:(""*AppData\Local\Programs\Microsoft VS Code\resources\app\node_modules*"" or ""*cmd.exe/c"" or ""cmd.exe /c""))) ";Detects Windows command lines that miss a space before or after the /c flag when running a command using the cmd.exe. This could be a sign of obfuscation of a fat finger problem (typo by the developer).;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_no_space_execution.yml ;
Ntdll.dll type content to a different file or pipe;Cmd.exe;"process.command_line : (""*type %windir%\system32\ntdll.dll*"" or ""*type %systemroot%\system32\ntdll.dll*"" or ""*type c:\windows\system32\ntdll.dll*"" or ""*\\ntdll.dll > \\\\.\\pipe\\*"") ";Detects command that type the content of ntdll.dll to a different file or a pipe in order to evade AV / EDR detection. As seen being used in the POC NtdllPipe;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_ntdllpipe_redirect.yml ;
Usage of the copy command to copy files from a remote share;Cmd.exe;"process.name: *cmd.exe and process.command_line : ((*copy* and ""*\\\\*"") or (""*.dmp*"" or ""*.dump*"")) ";"Detects usage of the copy builtin cmd command to copy files with the "".dmp""/"".dump"" extension from a remote share";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_copy_dmp_from_share.yml ;
"Usage of ""del"" to remove files using wildcards/greedy expressions";Cmd.exe;"process.name: *cmd.exe and process.command_line : ((*del* or *erase*) and (""*\\\*.dll*"" or ""*\\\*.exe*""))";"Detects execution of the ""del"" builtin command to remove files using greedy/wildcard expression. This is often used by malware to delete content of folders that perhaps contains the initial malware infection or to delete evidence.";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_del_greedy_deletion.yml ;
Replacement of sticky keys;Cmd.exe;"process.command_line : (*copy* and ""*/y*"" and ""*C:\windows\system32\cmd.exe C:\windows\system32\sethc.exe*"")";"By replacing the sticky keys executable with the local admins CMD executable, an attacker is able to access a privileged windows console session without authenticating to the system. When the sticky keys are ""activated"" the privileged shell is launched.";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_sticky_keys_replace.yml ;
Windows Task Scheduler for initial or recurring execution of malicious code ;Cmd.exe;" (winlog.event_data.ScriptBlockText : (*New-ScheduledTaskAction* or *New-ScheduledTaskTrigger* or *New-ScheduledTaskPrincipal* or *New-ScheduledTaskSettingsSet* or *New-ScheduledTask* or *Register-ScheduledTask*)) or (winlog.event_data.ScriptBlockText : (*Invoke-CimMethod* and *-ClassName* and *PS_ScheduledTask* and *-NameSpace* and ""*Root\Microsoft\Windows\TaskScheduler*"")) ";Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/powershell/powershell_script/posh_ps_cmdlet_scheduled_task.yml ;
Xp_cmdshell settings change;Cmd.exe;winlog.provider_name : MSQLSERVER and event.code : 15457 and event.original : *xp_cmdshell*;"Detects when the MSSQL ""xp_cmdshell"" stored procedure setting is changed";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/builtin/application/mssqlserver/win_mssql_xp_cmdshell_change.yml ;
Network connections ran with no command line parameters ;Cmd.exe;"process.name: (*regsvr32.exe or *rundll32.exe or *dllhost.exe) and process.command_line : (*regsvr32.exe or *rundll32.exe or *dllhost.exe) and not (process.command_line : ("""" or ""null"") )";Detects suspicious network connections made by a well-known Windows binary run with no command line parameters;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/network_connection/net_connection_win_susp_binary_no_cmdline.yml ;
Base64 malicious encoded strings ;Cmd.exe;process.name : (*powershell.exe or *pwsh.exe) and process.command_line : * hidden * and process.command_line : (*AGkAdABzAGEAZABtAGkAbgAgAC8AdAByAGEAbgBzAGYAZQByA* or *aXRzYWRtaW4gL3RyYW5zZmVy* or *IAaQB0AHMAYQBkAG0AaQBuACAALwB0AHIAYQBuAHMAZgBlAHIA* or *JpdHNhZG1pbiAvdHJhbnNmZX* or *YgBpAHQAcwBhAGQAbQBpAG4AIAAvAHQAcgBhAG4AcwBmAGUAcg* or *Yml0c2FkbWluIC90cmFuc2Zlc* or *AGMAaAB1AG4AawBfAHMAaQB6AGUA* or *JABjAGgAdQBuAGsAXwBzAGkAegBlA* or *JGNodW5rX3Npem* or *QAYwBoAHUAbgBrAF8AcwBpAHoAZQ* or *RjaHVua19zaXpl* or *Y2h1bmtfc2l6Z* or *AE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4A* or *kATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8Abg* or *lPLkNvbXByZXNzaW9u* or *SQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuA* or *SU8uQ29tcHJlc3Npb2* or *Ty5Db21wcmVzc2lvb* or *AE8ALgBNAGUAbQBvAHIAeQBTAHQAcgBlAGEAbQ* or *kATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtA* or *lPLk1lbW9yeVN0cmVhb* or *SQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0A* or *SU8uTWVtb3J5U3RyZWFt* or *Ty5NZW1vcnlTdHJlYW* or *4ARwBlAHQAQwBoAHUAbgBrA* or  *5HZXRDaHVua* or *AEcAZQB0AEMAaAB1AG4Aaw* or *LgBHAGUAdABDAGgAdQBuAGsA* or *LkdldENodW5r* or *R2V0Q2h1bm* or *AEgAUgBFAEEARABfAEkATgBGAE8ANgA0A* or *QASABSAEUAQQBEAF8ASQBOAEYATwA2ADQA* or *RIUkVBRF9JTkZPNj* or *SFJFQURfSU5GTzY0* or *VABIAFIARQBBAEQAXwBJAE4ARgBPADYANA* or *VEhSRUFEX0lORk82N* or *AHIAZQBhAHQAZQBSAGUAbQBvAHQAZQBUAGgAcgBlAGEAZA* or *cmVhdGVSZW1vdGVUaHJlYW* or *MAcgBlAGEAdABlAFIAZQBtAG8AdABlAFQAaAByAGUAYQBkA* or *NyZWF0ZVJlbW90ZVRocmVhZ* or *Q3JlYXRlUmVtb3RlVGhyZWFk* or *QwByAGUAYQB0AGUAUgBlAG0AbwB0AGUAVABoAHIAZQBhAGQA* or *0AZQBtAG0AbwB2AGUA* or *1lbW1vdm* or *AGUAbQBtAG8AdgBlA* or *bQBlAG0AbQBvAHYAZQ* or *bWVtbW92Z* or *ZW1tb3Zl* );Detects base64 encoded strings used in hidden malicious PowerShell command lines;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_powershell_hidden_b64_cmd.yml ;
Mount of a WebDAV server and inmediate execution of content;Cmd.exe;"process.name: *cmd.exe and process.command_line : (""* net use http*"" and ""*& start /b*"" and ""*\DavWWWRoot\*"") and process.command_line :(.exe or .dll or .bat or .vbs or .ps1) ";"Detects the execution of the ""net use"" command to mount a WebDAV server and then immediately execute some content in it. As seen being used in malicious LNK files";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_net_use_and_exec_combo.yml ;
"Output redirection using "">"" symbol ";Cmd.exe;"process.name : *cmd.exe and process.command_line : (""*> \Users\Public\*"" or ""*> %APPDATA%\*"" or ""*> %TEMP%\*"" or ""*> %TMP%\*"" or ""*> %USERPROFILE%\*"" or ""*> C:\Temp\*"" or ""*> C:\Users\Public\*"" or ""*> C:\Windows\Temp\*"" or ""*>\Users\Public\*"" or ""*>%APPDATA%\*"" or ""*>%TEMP%\*"" or ""*>%TMP%\*"" or ""*>%USERPROFILE%\*"" or ""*>C:\Temp\*"" or ""*>C:\Users\Public\*"" or ""*>C:\Windows\Temp\*"") or ((process.command_line : (""* >*"" or ""*´>*"")) and (process.command_line : (""*C:\Users\*"" and ""*\AppData\Local\*""))) ";"Detects inline windows shell commands redirecting output via the "">"" symbol to a suspicious location";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_redirection_susp_folder.yml ;
Usage to add generic credentials;Cmd.exe;"process.name: *cmdkey.exe and process.command_line : (""*/g*"" and ""*/u*"" and ""*/p*"")";Detects usage of cmdkey to add generic credentials. As an example, this has to be used before connecting to an RDP session via command line interface. ;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmdkey_adding_generic_creds.yml ;
"""curl"" comand to download payloads remotely";Cmd.exe;"process.command_line : (""* /c*"" and *curl* and *http* and ""*-o*"" and &)";Adversaries can use curl to download payloads remotely and execute them. Curl is included by default in Windows 10 build 17063 and later.;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_cmd_curl_download_exec_combo.yml ;
Xp_cmdshell used to execute commands;Cmd.exe;"event.original : (""*object_name:xp_cmdshel*"" and ""*statement:EXEC*"")";"Detects when the MSSQL ""xp_cmdshell"" stored procedure is used to execute commands ";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/builtin/application/mssqlserver/win_mssql_xp_cmdshell_audit_log.yml ;
Usage of cs.exe to create, modify or start services on remote hosts;Cmd.exe;"(event.category : process and event.type : (start or process_started) and (process.name : sc.exe or process.pe.original_file_name : sc.exe) and process.args : ""\\\\*"" and process.args : (""binPath=*"" or ""binpath=*"") and process.args : (create or config or failure or start)) or (event.category: network and process.name : sc.exe and not destination.ip : 127.0.0.1) ";Identifies use of sc.exe to create, modify, or start services on remote hosts. This could be indicative of adversary lateral movement but will be noisy if commonly done by admins.;https://github.com/elastic/detection-rules/blob/414d32027632a49fb239abb8fbbb55d3fa8dd861/rules/windows/lateral_movement_cmd_service.toml#L38 ;
Windows utilities used to dump LSASS or AD database;Cmd.exe;"event.category: process and event.type: (""start"" or ""process_started"") and (process.pe.original_file_name : ""procdump"" and process.args : ""-ma"") or (process.name : ""ProcessDump.exe"" and not process.parent.executable : ""C:\\Program Files*\\Cisco Systems\\*.exe"") or (process.pe.original_file_name : ""WriteMiniDump.exe"" and not process.parent.executable : ""C:\\Program Files*\\Steam\\*.exe"") or (process.pe.original_file_name : ""RUNDLL32.EXE"" and (process.args : ""MiniDump*"" or process.command_line : ""*comsvcs.dll*#24*"")) or (process.pe.original_file_name : ""RdrLeakDiag.exe"" and process.args : ""/fullmemdmp"") or (process.pe.original_file_name : ""SqlDumper.exe"" and process.args : ""0x01100*"") or (process.pe.original_file_name : ""TTTracer.exe"" and process.args : ""-dumpFull"" and process.args : ""-attach"") or (process.pe.original_file_name : ""ntdsutil.exe"" and process.args : ""create*full*"") or (process.pe.original_file_name : ""diskshadow.exe"" and process.args : ""/s"")";Identifies use of sc.exe to create, modify, or start services on remote hosts. This could be indicative of adversary lateral movement but will be noisy if commonly done by admins.;https://github.com/elastic/detection-rules/blob/414d32027632a49fb239abb8fbbb55d3fa8dd861/rules/windows/credential_access_cmdline_dump_tool.toml ;
Execution of macOS commands to dump account hashes;Cmd.exe;"event.category: process and event.type: (""start"" or ""process_started"") and (process.pe.original_file_name : ""procdump"" and process.args : ""-ma"") or (process.name : ""ProcessDump.exe"" and not process.parent.executable : ""C:\\Program Files*\\Cisco Systems\\*.exe"") or (process.pe.original_file_name : ""WriteMiniDump.exe"" and not process.parent.executable : ""C:\\Program Files*\\Steam\\*.exe"") or (process.pe.original_file_name : ""RUNDLL32.EXE"" and (process.args : ""MiniDump*"" or process.command_line : ""*comsvcs.dll*#24*"")) or (process.pe.original_file_name : ""RdrLeakDiag.exe"" and process.args : ""/fullmemdmp"") or (process.pe.original_file_name : ""SqlDumper.exe"" and process.args : ""0x01100*"") or (process.pe.original_file_name : ""TTTracer.exe"" and process.args : ""-dumpFull"" and process.args : ""-attach"") or (process.pe.original_file_name : ""ntdsutil.exe"" and process.args : ""create*full*"") or (process.pe.original_file_name : ""diskshadow.exe"" and process.args : ""/s"")";Identifies the execution of macOS built-in commands used to dump user account hashes. Adversaries may attempt to dump credentials to obtain account login information in the form of a hash. These hashes can be cracked or leveraged for lateral movement.;https://github.com/elastic/detection-rules/blob/414d32027632a49fb239abb8fbbb55d3fa8dd861/rules/macos/credential_access_dumping_hashes_bi_cmds.toml  ;
Python script executed using command line input and sys module;Cmd.exe;"event.category : process and event.type: (start or process_started) and process.name python* and process.args: ""*-c*"" and process.args: ""*import*sys*""";Identifies when a Python script is executed using command line input and imports the sys module. Attackers often use this method to execute malicious scripts and avoiding writing it to disk.;https://github.com/elastic/detection-rules/blob/414d32027632a49fb239abb8fbbb55d3fa8dd861/rules/cross-platform/execution_python_script_in_cmdline.toml  ;
Reverse shell activity suspicion;Cmd.exe;"event.category: process and event.type: (start or process_started) and process.name: (sh* or bash* or zsh* or dash* or zmodload*) and process.args: (""*/dev/tcp/*"" or ""*/dev/udp/*"" or ""zsh/net/tcp"" or ""zsh/net/udp"")";Identifies the execution of a shell process with suspicious arguments which may be indicative of reverse shell activity.;https://github.com/elastic/detection-rules/blob/414d32027632a49fb239abb8fbbb55d3fa8dd861/rules/cross-platform/execution_revershell_via_shell_cmd.toml ;
Execution via MSSQL xp_cmdshell stored procedure;Cmd.exe;event.category: process and event.category: (start or process_started) and process.name : *cmd* and process.parent.name : sqlservr.exe;Identifies execution via MSSQL xp_cmdshell stored procedure. Malicious users may attempt to elevate their privileges by using xp_cmdshell, which is disabled by default, thus, it's important to review the context of it's use.;https://github.com/elastic/detection-rules/blob/414d32027632a49fb239abb8fbbb55d3fa8dd861/rules/windows/execution_via_xp_cmdshell_mssql_stored_procedure.toml ;
Collect keychain storage data from a system;Cmd.exe;"event.category: process and event.category: (start or process_started) and process.name : *security* and process.args:(""find-generic-password"" or ""find-internet-password"")";Adversaries may collect keychain storage data from a system to in order to acquire credentials. Keychains are the built-in way for macOS to keep track of users' passwords and credentials for many services and features, including Wi-Fi and website passwords, secure notes, certificates, and Kerberos.;https://github.com/elastic/detection-rules/blob/414d32027632a49fb239abb8fbbb55d3fa8dd861/rules/macos/credential_access_keychain_pwd_retrieval_security_cmd.toml ;
Copy operation of the AD Domain Database or  Security Account Manager (SAM) files;Cmd.exe;"event.category: process and event.type :(""start"" or ""process_started"") and process.pe.original_file_name : (""Cmd.Exe"" or ""PowerShell.EXE"" or ""XCOPY.EXE"") and process.args : (""*copy*"" or  ""*xcopy*"" or ""*Copy-Item*"" or ""*move*"" or ""*cp*"" or ""*mv*"") and process.args : (""*\\ntds.dit*"" or ""*\\config\\SAM*"" or ""*\\*\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy*\\*"") ";Identifies a copy operation of the Active Directory Domain Database (ntds.dit) or Security Account Manager (SAM) files. Those files contain sensitive information including hashed domain and/or local credentials.;https://github.com/elastic/detection-rules/blob/414d32027632a49fb239abb8fbbb55d3fa8dd861/rules/windows/credential_access_copy_ntds_sam_volshadowcp_cmdline.toml ;
Suspicious SolarWinds child process;Cmd.exe;"event.category: process and event.type : (""start"" or ""process_started"") and process.name: (""cmd.exe"" or ""powershell.exe"") and process.parent.name: ( ""ConfigurationWizard*.exe"" or ""NetflowDatabaseMaintenance*.exe"" or ""NetFlowService*.exe"" or ""SolarWinds.Administration*.exe"" or ""SolarWinds.Collector.Service*.exe"" or ""SolarwindsDiagnostics*.exe"" )";A suspicious SolarWinds child process (Cmd.exe or Powershell.exe) was detected.;https://github.com/elastic/detection-rules/blob/414d32027632a49fb239abb8fbbb55d3fa8dd861/rules/windows/execution_apt_solarwinds_backdoor_child_cmd_powershell.toml ;
