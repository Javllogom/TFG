title;binary;rule;description;link;columns
Suspicious execution which can be abused to download files ;CertReq.exe ;(process.name : (*certreq.exe or *CertReq.exe) or process.executable : (*certreq.exe or *CertReq.exe)) and (process.command_line : (*-Post* and *-config* and *http* and (*windows* or *Windows*) and *win.ini* ));Detects a suspicious certreq execution taken from the LOLBAS examples, which can be abused to download (small) files;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_lolbin_susp_certreq_download.yml  ;
Execution of certutil with decode or decodehex flags;Certutil.exe;process.executable:*certutil.exe and (process.command_line: *-decode* or process.command_line:*/decode* or process.command_line:*-decodehex* or process.command_line:*/decodehex*);"Detects the execution of certutil with either the ""decode"" or ""decodehex"" flags to decode base64 or hex encoded files. This can be abused by attackers to decode an encoded payload before execution ";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_certutil_decode.yml ;
Execution of certutil with decode to encode file to base64;Certutil.exe;process.executable: *certutil.exe and(process.command_line: *-encode* or*//encode*);"Detects the execution of certutil with the ""encode"" flag to encode a file to base64. This can be abused by threat actors and attackers for data exfiltration ";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_certutil_encode.yml ;
Execution with certain flags to download files;Certutil.exe;process.executable: *certutil.exe and process.command_line: *http* and (process.command_line: *urlcache* or process.command_line: *verifyctl*);Detects the execution of certutil with certain flags that allow the utility to download files. ;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_certutil_download.yml  ;
ExportPFX flag which allows to export certificates;Certutil.exe;process.executable: *certutil.exe and (process.command_line:*-exportPFX* or process.command_line:*/exportPFX*);"Detects the execution of the certutil with the ""exportPFX"" flag which allows the utility to export certificates. ";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_certutil_export_pfx.yml ;
Possible NTLM coercionusing the syncwithWU flag;Certutil.exe;process.executable: *certutil.exe and (process.command_line:* -syncwithWU and process.command_line:**\\\\*) and not (process.command_line: *win-rfe-test.copyright.com*);Detects possible NTLM coercion via certutil using the 'syncwithWU' flag ;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_certutil_ntlm_coercion.yml ;
Flag detection that allows to download files from direct IPs;Certutil.exe;(process.name: CertUtil.exe) and(process.command_line: *urlcache * or *verifyct1 *) and(process.command_line : *\://1* or*\://2* or*\://3* or*\://4* or*\://5* or*\://6* or*\://7*);Detects the execution of certutil with certain flags that allow the utility to download files from direct IPs. ;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_certutil_download_direct_ip.yml ;
Execution with encode flag to encode file to base64 with a suspicious location;Certutil.exe;process.executable: *certutil.exe and (process.command_line: *-encode* or process.command_line:*/encode*) and (process.command_line: *\\AppData\\Roaming\\* and process.command_line: *\\Desktop\\* or process.command_line: *\\Local\\Temp\\* or process.command_line: *\\PerfLogs\\* or process.command_line: *\\Users\\Public\\* or process.command_line: *\\Windows\\Temp\\* or process.command_line: *$Recycle.Bin*);"Detects the execution of certutil with the ""encode"" flag to encode a file to base64 where the files are located in potentially suspicious locations ";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_certutil_encode_susp_location.yml ;
Execution with encode flag to encode file to base64 with a suspicious extension;Certutil.exe;process.executable: *certutil.exe and (process.commmand_line: *-encode* or process.command_line: */encode*) and (process.command_line: *.acl* or process.command_line:*.bat* or process.command_line: process.command_line: *.gif* or *.doc* or process.command_line:*.jpeg* or process.command_line:*.jpg* or process.command_line: *.mp3* or process.command_line: *.pdf* or process.command_line:*.png* or process.command_line:*.ppt* or process.command_line: *.tmp* or process.command_line: *.xls* or process.command_line: *.xml*);"Detects the execution of certutil with the ""encode"" flag to encode a file to base64 where the extensions of the file is suspicious ";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_certutil_encode_susp_extensions.yml ;
Network connection initiated by certutil;Certutil.exe;process.executable : *\\certutil.exe* and destination.port: (80 or 135 or 443 or 445);Detects a network connection initiated by the certutil.exe tool. Attackers can abuse the utility in order to download malware or additional payloads. ;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/network_connection/net_connection_win_certutil_initiated_connection.yml ;
Execution with addstore flag to install a new certificate on the system;Certutil.exe;process.executable: *certutil.exe and (process.command_line:*/addstore* or process.command_line:*-addstore*) and process.command_line:*root*;"Detects execution of ""certutil"" with the ""addstore"" flag in order to install a new certificate on the system. Adversaries may install a root certificate on a compromised system to avoid warnings when connecting to adversary controlled web servers. ";https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_certutil_certificate_installation.yml ;
Execution with flags that allow it to download files from websites;Certutil.exe;process.executable: *\\certutil.exe and (process.command_line: *urlcache * or process.command_line: *verifyctl *) and (process.command_line: *.ghostbin.co/* or process.command_line:*.hastebin.com* or process.command_line:*.paste.ee* or process.command_line:*anonfiles.com* or process.command_line:*cdn.discordapp.com/attach or process.command_line: *ddns.net* or process.command_line: *gist.githubusercontent.cc or process.command_line: *mediafire.com* or process.command_line: *mega.nz* or process.command_line:*paste.ee* or process.command_line: *pastebin.com* or process.command_line: *pastebin.pl* or process.command_line:*pastetext.net* or process.command_line: *privatlab.com* or process.command_line: *privatlab.net* or process.command_line:*raw.githubusercontent.com or process.command_line:*send.exploit.in* or process.command_line:*sendspace.com* or process.command_line:*storage.googleapis.com* or process.command_line: *transfer.sh* or process.command_line:*ufile.io*);Detects the execution of certutil with certain flags that allow the utility to download files from file-sharing websites. ;https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_certutil_download_file_sharing_domains.yml ;
Execution with suspicious subcommands;Certutil.exe;process.executable: *certutil.exe and  (process.command_line:* -decode * or process.command_line:* -decodehex * or process.command_line:* -urlcache * or process.command_line:* -verifyctl * or process.command_line:* -encode * or process.command_line:* -exportPFX * or process.command_line:* /decode * or process.command_line:* /decodehex * or process.command_line:* /urlcache * or process.command_line:* /verifyctl * or process.command_line:* /encode * or process.command_line:* /exportPFX *);Detects a suspicious Microsoft certutil execution with sub commands like 'decode' sub command, which is sometimes used to decode malicious code ;https://copyrightclearancecenter-my.sharepoint.com/personal/jjgomez_copyright_com/_layouts/15/Doc.aspx?sourcedoc={f953deb5-0763-4424-8c38-15ea42ca1bab}&action=edit&wd=target%28Threat%20Hunting.one%7C8ab00bb7-7fc5-43b3-ba90-954272bd8e0d%2FCertutil.exe%20-%20Nick%7C09579234-679f-43c9-9237-afd80a152d96%2F%29&wdorigin=NavigationUrl;
